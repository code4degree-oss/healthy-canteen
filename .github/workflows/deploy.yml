# name: Deploy to Production
# 
# on:
#   push:
#     branches: [ "main" ]
# 
# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Deploy to Server
#         uses: appleboy/ssh-action@v1.0.3
#         with:
#           host: ${{ secrets.HOST }}
#           username: ${{ secrets.USERNAME }}
#           key: ${{ secrets.SSH_KEY }}
#           script: |
#             # 1. Navigate to project folder
#             cd /var/www/the-healthy-canteen
# 
#             # 2. Pull latest code
#             git pull origin main
# 
#             # 3. Backend: Install & Build
#             cd backend
#             npm install
#             npm run build
#             # Ensure dist/server.js exists or adjust start command if needed
#            
#             cd ..
# 
#             # 4. Frontend: Install & Build
#             npm install
#             npm run build
# 
#             # 5. Restart Backend
#             # Check if PM2 process exists, if not start it, otherwise restart
#             if pm2 list | grep -q "hct-backend"; then
#               pm2 restart hct-backend
#             else
#               cd backend
#               pm2 start dist/server.js --name "hct-backend"
#               cd ..
#             fi
# 
#             # 6. Cleanup (Optional)
#             echo "Deployment Complete!"
